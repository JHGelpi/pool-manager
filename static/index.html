<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pool Manager</title>
  <link rel="stylesheet" href="./css/styles.css">
</head>
<body>
  <header class="header">
    <h1>🏊 Pool Manager</h1>
    <span id="statusBadge" class="badge badge-ok">● Online</span>
  </header>

  <div id="app">
    <!-- Tasks Tab -->
    <section id="tab-tasks" class="tab active">
      <div class="section-header">
        <h2>Maintenance Tasks</h2>
        <button id="btnAddTask" class="btn btn-primary">+ Add Task</button>
      </div>

      <div id="tasksLoading" class="loading">Loading tasks...</div>
      <div id="tasksList" class="cards-grid"></div>
      <div id="tasksEmpty" class="empty" style="display: none;">
        <p>No maintenance tasks yet</p>
        <button id="btnAddTaskEmpty" class="btn btn-primary">Create First Task</button>
      </div>
    </section>

    <!-- Inventory Tab -->
    <section id="tab-inventory" class="tab">
      <div class="section-header">
        <h2>Chemical Inventory</h2>
        <button id="btnAddInventory" class="btn btn-primary">+ Add Item</button>
      </div>

      <div id="inventoryLoading" class="loading">Loading inventory...</div>
      <div id="inventoryList" class="cards-grid"></div>
      <div id="inventoryEmpty" class="empty" style="display: none;">
        <p>No inventory items yet</p>
        <button id="btnAddInventoryEmpty" class="btn btn-primary">Add First Item</button>
      </div>
    </section>

    <!-- Readings Tab -->
    <section id="tab-readings" class="tab">
      <div class="section-header">
        <h2>Water Readings</h2>
      </div>

      <div class="card">
        <form id="readingForm">
          <div class="form-group">
            <label for="readingType">Reading Type</label>
            <select id="readingType" required>
              <option value="">Select type...</option>
            </select>
          </div>

          <div class="form-group">
            <label for="readingValue">Value</label>
            <input id="readingValue" type="number" step="0.01" placeholder="Enter value" required>
            <span id="readingUnit" class="unit"></span>
          </div>

          <div class="form-group">
            <label for="readingDate">Date</label>
            <input id="readingDate" type="date" required>
          </div>

          <button type="submit" class="btn btn-primary">Save Reading</button>
        </form>
      </div>

      <div class="card">
        <canvas id="readingChart" height="250"></canvas>
      </div>
    </section>

    <!-- Settings Tab -->
    <section id="tab-settings" class="tab">
      <div class="section-header">
        <h2>Settings</h2>
      </div>

      <div class="card">
        <div class="info-row">
          <span>API Status</span>
          <strong id="apiStatus">Checking...</strong>
        </div>
        <div class="info-row">
          <span>Database</span>
          <strong id="dbStatus">Checking...</strong>
        </div>
        <div class="info-row">
          <span>Version</span>
          <strong>1.0.0</strong>
        </div>
      </div>
    </section>
  </div>

  <!-- Task Dialog -->
  <dialog id="taskDialog" class="modal">
    <form id="taskForm">
      <h3>Add Maintenance Task</h3>

      <div class="form-group">
        <label for="taskName">Task Name *</label>
        <input id="taskName" name="name" type="text" required placeholder="e.g., Clean filter">
      </div>

      <div class="form-group">
        <label for="taskDescription">Description</label>
        <textarea id="taskDescription" name="description" rows="3" placeholder="Optional notes"></textarea>
      </div>

      <div class="form-group">
        <label for="taskFrequency">Frequency (days) *</label>
        <input id="taskFrequency" name="frequency_days" type="number" min="1" value="7" required>
      </div>

      <div class="form-group">
        <label for="taskDueDate">Next Due Date *</label>
        <input id="taskDueDate" name="next_due_date" type="date" required>
      </div>

      <div class="modal-actions">
        <button type="button" id="taskCancel" class="btn">Cancel</button>
        <button type="submit" class="btn btn-primary">Save Task</button>
      </div>
    </form>
  </dialog>

  <!-- Inventory Dialog -->
  <dialog id="inventoryDialog" class="modal">
    <form id="inventoryForm">
      <h3>Add Inventory Item</h3>

      <div class="form-group">
        <label for="invName">Chemical Name *</label>
        <input id="invName" name="name" type="text" required placeholder="e.g., Chlorine Tablets">
      </div>

      <div class="form-group">
        <label for="invQuantity">Quantity on Hand *</label>
        <input id="invQuantity" name="quantity_on_hand" type="number" step="0.1" min="0" required>
      </div>

      <div class="form-group">
        <label for="invUnit">Unit *</label>
        <input id="invUnit" name="unit" type="text" required placeholder="e.g., lbs, gallons">
      </div>

      <div class="form-group">
        <label for="invThreshold">Reorder Threshold *</label>
        <input id="invThreshold" name="reorder_threshold" type="number" step="0.1" min="0" required>
      </div>

      <div class="modal-actions">
        <button type="button" id="inventoryCancel" class="btn">Cancel</button>
        <button type="submit" class="btn btn-primary">Save Item</button>
      </div>
    </form>
  </dialog>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <button class="nav-btn active" data-tab="tasks">
      <span>📋</span>
      <span>Tasks</span>
    </button>
    <button class="nav-btn" data-tab="inventory">
      <span>🧪</span>
      <span>Inventory</span>
    </button>
    <button class="nav-btn" data-tab="readings">
      <span>📊</span>
      <span>Readings</span>
    </button>
    <button class="nav-btn" data-tab="settings">
      <span>⚙️</span>
      <span>Settings</span>
    </button>
  </nav>

  <!-- Toast Notification -->
  <div id="toast" class="toast"></div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="./js/app.js?v=2"></script>
</body>
</html>